{% extends "blog/base.html" %}
{% load static %}
{% block content %}
  {% for post in posts %}
    <article class="card post-card border-0 shadow-sm mb-4">
      <div class="card-body p-4 p-md-5">
        <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
          <span class="badge rounded-pill text-bg-light border">published · {{ post.publish_date|date:"Y-m-d" }}</span>
        </div>
        <h2 class="h4 fw-bold mb-3">
          <!-- 帖子标题链接，点击跳转到详情页 -->
          <a class="post-title-link" href="{% url "post_detail" pk=post.pk %}">{{ post.title }}</a>
        </h2>
        <!-- 正文：默认折叠 4 行，JS 会检测是否需要显示按钮 -->
        <div id="post-body-{{ forloop.counter }}"
             class="post-body is-collapsed"
             data-lines="4">{{ post.text|linebreaks }}</div>
        <!-- 图标按钮：默认隐藏，只有超过 4 行才显示 -->
        <button type="button"
                class="btn btn-sm btn-outline-primary post-toggle mt-3"
                data-target="post-body-{{ forloop.counter }}"
                aria-expanded="false"
                aria-label="展开全文"
                hidden>
          <!-- 默认：向下箭头（展开） -->
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </div>
    </article>
  {% endfor %}
  <script src="{% static 'blog/js/index/index.js' %}"></script>
{% endblock content %}
